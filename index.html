<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tetris</title>
    <style>
        html,
        body {
            height: 100%;
            margin: 0;
        }

        /* add background set position and color */
        body {
            background: black;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        canvas {
            border: 1px solid white;
        }
    </style>
</head>

<body>
    <canvas width="320" height="640" id="geme"></canvas>
    <script>
        const canvas = document.getElementById('game');
        const context = canvas.getContext('2d');
        //elem size
        const grid = 32;
        var tetrominoSequence = [];
        var playfield = [];

        for (let row = -2; row < 20; row++) {
            playfield[row] = [];

            for (let col = 0; col < 10; col++) {
                playfield[row][col] = 0;
            }
        }

        // set forms for elements
        const tetrominos = {
            'I': [
                [0, 0, 0, 0],
                [1, 1, 1, 1],
                [0, 0, 0, 0],
                [0, 0, 0, 0],
            ],
            'J': [
                [1, 0, 0],
                [1, 1, 1],
                [0, 0, 0],
            ],
            'L': [
                [0, 0, 1],
                [1, 1, 1],
                [0, 0, 0],
            ],
            'O': [
                [1, 1],
                [1, 1],
            ],
            'S': [
                [0, 1, 1],
                [1, 1, 0],
                [0, 0, 0],
            ],
            'Z': [
                [1, 1, 0],
                [0, 1, 1],
                [0, 0, 0],
            ],
            'T': [
                [0, 1, 0],
                [1, 1, 1],
                [0, 0, 0],
            ]
        };

        // set colors for game elements
        const colors = {
            'I': 'cyan',
            'O': 'yellow',
            'T': 'purple',
            'S': 'green',
            'Z': 'red',
            'J': 'blue',
            'L': 'orange',
        };

        //counter
        let count = 0;
        //current element 
        let tetromino = getNextTetromino();
        //track animation for can stop game
        let rAF = null;
        // flag of the end gamge, on the start don't active
        let gameOver = false;

        // get random numbers
        function getRandomInt(min, max) {
            min = Math.ceil(min);
            max = Math.ceil(max);

            return Math.floor(Math.random() * (max - min + 1)) + min;
        }

        // generate sequence of elements
        function generateSequence() {
            const sequence = ['I', 'J', 'L', 'O', 'S', 'T', 'Z'];

            while (sequence.length) {
                const rand = getRandomInt(0, sequence.length - 1);
                const name = sequence.splice(rand, 1)[0];
                // put selected elem in arr sequence
                tetrominoSequence.push(name);
            }
        }

        function getNextTetromino() {
            if (tetrominoSequence.length === 0) {
                generateSequence();
            }
            // take first elem from arr
            const name = tetrominoSequence.pop();
            const matrix = tetrominos[name];

            const col = playfield[0].length / 2 - Math.ceil(matrix[0].length / 2);
            const row = name === 'I' ? -1 : -2;

            return {
                name: name, // name of elem (L, O, etc)
                matrix: matrix, // matrix with elem
                row: row,
                col: col
            };
        }


    </script>

</body>

</html>